<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Quote of the Day</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
      display: flex;
      min-height: 100vh;
      align-items: center;
      justify-content: center;
    }

    .card {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      max-width: 420px;
      width: 100%;
      text-align: center;
    }

    h1 {
      font-size: 1.4rem;
      margin-bottom: 1rem;
    }

    #quote {
      font-size: 1rem;
      line-height: 1.5;
      margin-bottom: 1.5rem;
      color: #333;
      min-height: 3em;
    }

    button {
      padding: 0.6rem 1.2rem;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 600;
      background: #111827;
      color: white;
      margin: 0.25rem;
    }

    button:hover {
      opacity: 0.9;
    }

    textarea {
      font-family: inherit;
      font-size: 0.9rem;
      padding: 0.5rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      resize: vertical;
    }

    #saved {
      min-height: 1.2em;
      font-size: 0.9rem;
      color: #555;
      margin-top: 0.5rem;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>Quote of the Day</h1>
    <p id="quote">Click the button to see a quote.</p>

    <button id="new-quote">New quote</button>
    <button id="favourite">‚ù§Ô∏è Save favourite</button>
<button id="deleteQuote">üóëÔ∏è Delete this quote</button>
<button id="openBin">‚ôªÔ∏è Recycle bin</button>

    <p id="saved"></p>

    <textarea
      id="customQuote"
      placeholder="Write your own quote..."
      rows="3"
      style="width:100%; margin-top:1rem;"
    ></textarea>
    <br><br>
    <button id="addQuote">Add quote</button>
    <br><br>
    <button id="viewFavourite">View favourite</button>
  </div>

  <script>
  // ---- DEFAULT QUOTES ----
const defaultQuotes = [
  "Life is really simple, but we insist on making it complicated.",
  "The present moment is all you ever have.",
  "You are not a drop in the ocean. You are the entire ocean in a drop.",
  "What you seek is seeking you.",
  "Silence is a source of great strength."
];

// ---- LOAD ALL QUOTES (MIGRATE OLD DATA SAFELY) ----
let allQuotes = JSON.parse(localStorage.getItem("allQuotes"));
if (!Array.isArray(allQuotes) || allQuotes.length === 0) {
  const legacy = JSON.parse(localStorage.getItem("quotesList"));
  allQuotes = Array.isArray(legacy) && legacy.length ? legacy : defaultQuotes.slice();
  localStorage.setItem("allQuotes", JSON.stringify(allQuotes));
}

// ---- DOM ----
const quoteElement = document.getElementById("quote");
const newQuoteButton = document.getElementById("new-quote");
const favouriteButton = document.getElementById("favourite");
const deleteButton = document.getElementById("deleteQuote");
const savedText = document.getElementById("saved");
const viewButton = document.getElementById("viewFavourite");
const addButton = document.getElementById("addQuote");
const input = document.getElementById("customQuote");
const binButton = document.getElementById("openBin");

// ---- NON-REPEATING ORDER ----
function resetOrder() {
  const order = allQuotes.map((_, i) => i);
  for (let i = order.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [order[i], order[j]] = [order[j], order[i]];
  }
  localStorage.setItem("quoteOrder", JSON.stringify(order));
  localStorage.setItem("quoteOrderIndex", "0");
  return order;
}

let order = JSON.parse(localStorage.getItem("quoteOrder"));
let orderIndex = parseInt(localStorage.getItem("quoteOrderIndex") || "0", 10);
if (!Array.isArray(order) || order.length !== allQuotes.length) {
  order = resetOrder();
  orderIndex = 0;
}

let currentIndex = null;

function showNextQuote() {
  if (!allQuotes.length) {
    quoteElement.textContent = "No quotes left.";
    return;
  }
  if (orderIndex >= order.length) {
    order = resetOrder();
    orderIndex = 0;
  }
  currentIndex = order[orderIndex];
  quoteElement.textContent = allQuotes[currentIndex];
  savedText.textContent = "";
  orderIndex++;
  localStorage.setItem("quoteOrderIndex", String(orderIndex));
}

newQuoteButton.addEventListener("click", showNextQuote);

// ---- FAVOURITES ----
favouriteButton.addEventListener("click", () => {
  const q = quoteElement.textContent.trim();
  if (!q || q === "Click the button to see a quote.") {
    savedText.textContent = "Show a quote first!";
    return;
  }
  let fav = JSON.parse(localStorage.getItem("favouritesList")) || [];
  if (!fav.includes(q)) {
    fav.push(q);
    localStorage.setItem("favouritesList", JSON.stringify(fav));
    savedText.textContent = "Saved!";
  } else {
    savedText.textContent = "Already saved!";
  }
});

// ---- ADD CUSTOM QUOTE ----
addButton.addEventListener("click", () => {
  const q = input.value.trim();
  if (!q) {
    savedText.textContent = "Write something first!";
    return;
  }
  if (!allQuotes.includes(q)) {
    allQuotes.push(q);
    localStorage.setItem("allQuotes", JSON.stringify(allQuotes));
    order.push(allQuotes.length - 1); // add to rotation without breaking order
    localStorage.setItem("quoteOrder", JSON.stringify(order));
  }
  // also add to favourites
  let fav = JSON.parse(localStorage.getItem("favouritesList")) || [];
  if (!fav.includes(q)) {
    fav.push(q);
    localStorage.setItem("favouritesList", JSON.stringify(fav));
  }
  quoteElement.textContent = q;
  input.value = "";
  savedText.textContent = "Quote added!";
});

// ---- DELETE -> RECYCLE BIN ----
deleteButton.addEventListener("click", () => {
  if (currentIndex === null) {
    savedText.textContent = "No quote to delete.";
    return;
  }

  const q = allQuotes[currentIndex];

  let bin = JSON.parse(localStorage.getItem("recycleBin")) || [];
  bin.push(q);
  localStorage.setItem("recycleBin", JSON.stringify(bin));

  // remove from main list
  allQuotes.splice(currentIndex, 1);
  localStorage.setItem("allQuotes", JSON.stringify(allQuotes));

  // remove from favourites
  let fav = JSON.parse(localStorage.getItem("favouritesList")) || [];
  fav = fav.filter(x => x !== q);
  localStorage.setItem("favouritesList", JSON.stringify(fav));

  // reset rotation cleanly
  order = resetOrder();
  orderIndex = 0;

  showNextQuote();
  savedText.textContent = "Moved to recycle bin.";
});

// ---- NAVIGATION ----
viewButton.addEventListener("click", () => window.location.href = "favourite.html");
binButton.addEventListener("click", () => window.location.href = "bin.html");

  </script>
</body>
</html>

